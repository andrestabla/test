<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bater√≠a MD-IA (AlgoritmoT) ‚Äì Cuestionario interactivo</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
  <style>
    :root {
      --bg: #0b1021;
      --panel: #0f172a;
      --panel-soft: #101933;
      --border: #1e293b;
      --accent: #2563eb;
      --accent-2: #06b6d4;
      --accent-3: #22c55e;
      --danger: #ef4444;
      --warn: #f59e0b;
      --text: #e2e8f0;
      --muted: #94a3b8;
      --shadow: 0 20px 60px rgba(0, 0, 0, 0.45);
      --radius: 18px;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Inter', system-ui, -apple-system, sans-serif;
      background: radial-gradient(circle at 18% 18%, #11182f 0%, #060b1d 38%, #040816 90%);
      color: var(--text);
      min-height: 100vh;
      display: grid;
      grid-template-columns: 240px 1fr;
    }
    aside {
      position: sticky;
      top: 0;
      align-self: start;
      height: 100vh;
      padding: 20px 14px;
      background: #0a1023;
      border-right: 1px solid var(--border);
      box-shadow: inset -1px 0 0 rgba(255,255,255,0.02);
      display: grid;
      gap: 18px;
    }
    .brand {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 12px;
      background: linear-gradient(120deg, rgba(37,99,235,0.18), rgba(6,182,212,0.12));
      border: 1px solid rgba(59,130,246,0.26);
      border-radius: 16px;
      box-shadow: var(--shadow);
    }
    .logo { width: 32px; height: 32px; border-radius: 12px; background: conic-gradient(from 120deg, var(--accent), var(--accent-2), var(--accent-3)); display:flex; align-items:center; justify-content:center; font-weight: 800; color: #020617; }
    .brand span { font-weight: 700; font-size: 14px; }
    .menu { display: grid; gap: 6px; }
    .menu button {
      all: unset;
      cursor: pointer;
      padding: 10px 12px;
      border-radius: 12px;
      color: var(--muted);
      display: flex;
      align-items: center;
      gap: 10px;
      transition: all 0.15s ease;
    }
    .menu button:hover { background: rgba(255,255,255,0.05); color: var(--text); }
    .menu button.active { background: var(--panel); border: 1px solid var(--border); color: var(--text); box-shadow: 0 12px 28px rgba(0,0,0,0.35); }
    main { padding: 18px 18px 28px; max-width: 1180px; width: 100%; margin: 0 auto; }
    header.hero { background: linear-gradient(120deg, rgba(37,99,235,0.12), rgba(34,197,94,0.1)); border: 1px solid rgba(59,130,246,0.22); border-radius: 22px; padding: 16px; box-shadow: var(--shadow); display:grid; grid-template-columns: minmax(0,1.7fr) minmax(280px,1fr); gap: 14px; }
    h1 { font-size: 24px; margin-bottom: 6px; }
    p { color: var(--muted); line-height: 1.4; }
    .pill { display: inline-flex; align-items: center; gap: 6px; padding: 6px 10px; background: rgba(255,255,255,0.04); border: 1px solid rgba(255,255,255,0.06); color: var(--muted); border-radius: 999px; font-size: 12px; }
    .badge { width: 10px; height: 10px; border-radius: 999px; background: var(--accent-3); }
    .hero-score { font-size: 32px; font-weight: 700; }
    .hero-score small { font-size: 14px; color: var(--muted); font-weight: 500; margin-left: 4px; }
    .hero-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px,1fr)); gap: 10px; margin-top: 10px; }
    .stat { background: var(--panel); border: 1px solid var(--border); padding: 12px; border-radius: var(--radius); }
    .stat label { display: block; font-size: 12px; color: var(--muted); margin-bottom: 4px; }
    .stat strong { font-size: 18px; }
    .download { margin-top: 10px; display: inline-flex; align-items: center; gap: 8px; padding: 10px 12px; border-radius: 12px; background: linear-gradient(120deg, rgba(37,99,235,0.18), rgba(34,197,94,0.14)); border: 1px solid rgba(59,130,246,0.35); color: #e2e8f0; text-decoration: none; font-weight: 600; font-size: 14px; box-shadow: 0 12px 30px rgba(37,99,235,0.25); }
    .download:hover { filter: brightness(1.05); }
    .banner { position: sticky; top: 0; z-index: 20; margin-top: 14px; padding: 10px 12px; background: #0c1429; border: 1px solid var(--border); border-radius: 14px; display: flex; gap: 10px; align-items: center; flex-wrap: wrap; box-shadow: 0 12px 30px rgba(0,0,0,0.35); }
    .banner span { display: inline-flex; align-items: center; gap: 6px; color: var(--muted); font-size: 12px; }
    .grid { display: grid; gap: 12px; }
    .grid-2 { grid-template-columns: minmax(0,1.6fr) minmax(280px,1fr); align-items: start; }
    .card { background: var(--panel); border: 1px solid var(--border); border-radius: var(--radius); padding: 14px 14px 16px; box-shadow: var(--shadow); }
    .card + .card { margin-top: 12px; }
    .card-header { display: flex; align-items: baseline; justify-content: space-between; gap: 10px; margin-bottom: 8px; }
    .card-title { font-size: 16px; font-weight: 600; }
    .card-subtitle { color: var(--muted); font-size: 13px; }
    .wizard-controls { display: flex; justify-content: space-between; gap: 10px; margin-top: 12px; }
    .btn { border: none; background: linear-gradient(120deg, var(--accent), var(--accent-2)); color: #0b1021; padding: 10px 12px; border-radius: 12px; font-weight: 700; cursor: pointer; box-shadow: 0 12px 30px rgba(37,99,235,0.35); }
    .btn.secondary { background: rgba(255,255,255,0.05); color: var(--text); box-shadow: none; border: 1px solid var(--border); }
    .btn:disabled { opacity: 0.35; cursor: not-allowed; }
    .progress { width: 100%; height: 9px; background: #0b1221; border-radius: 999px; overflow: hidden; border: 1px solid var(--border); margin-top: 6px; }
    .progress-bar { height: 100%; background: linear-gradient(90deg, var(--accent), var(--accent-3)); width: 0%; transition: width 0.25s ease; }
    .question-list { display: grid; gap: 10px; margin-top: 10px; }
    .question { background: var(--panel-soft); border: 1px solid var(--border); padding: 12px; border-radius: 14px; display: grid; gap: 6px; }
    .question h4 { font-size: 13px; display: flex; align-items: center; gap: 8px; }
    .question .tag { font-size: 11px; padding: 3px 8px; border-radius: 999px; border: 1px solid var(--border); color: var(--muted); }
    .options { display: grid; grid-template-columns: repeat(auto-fit, minmax(90px, 1fr)); gap: 6px; }
    .options button {
      border: 1px solid rgba(255,255,255,0.08);
      background: rgba(255,255,255,0.04);
      color: var(--text);
      padding: 10px 12px;
      border-radius: 12px;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.12s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
    }
    .options button.selected { box-shadow: 0 12px 28px rgba(0,0,0,0.35), inset 0 0 0 1px rgba(255,255,255,0.1); }
    .options button[data-value="1"] { background: rgba(239,68,68,0.15); border-color: rgba(239,68,68,0.3); }
    .options button[data-value="2"] { background: rgba(245,158,11,0.15); border-color: rgba(245,158,11,0.3); }
    .options button[data-value="3"] { background: rgba(234,179,8,0.15); border-color: rgba(234,179,8,0.3); }
    .options button[data-value="4"] { background: rgba(34,197,94,0.16); border-color: rgba(34,197,94,0.32); }
    .options button[data-value="5"] { background: rgba(16,185,129,0.2); border-color: rgba(16,185,129,0.36); }
    .status { margin-top: 8px; font-size: 12px; color: var(--muted); display: flex; gap: 10px; align-items: center; flex-wrap: wrap; }
    .breadcrumb { font-size: 12px; color: var(--muted); }
    .block-progress { display: flex; align-items: center; gap: 10px; justify-content: space-between; }
    .block-name { font-weight: 600; color: var(--text); }
    .chip { display: inline-flex; align-items: center; gap: 6px; padding: 6px 10px; border-radius: 999px; background: rgba(255,255,255,0.04); border: 1px solid var(--border); font-size: 12px; }
    .chart-wrap { background: var(--panel); border: 1px solid var(--border); border-radius: var(--radius); padding: 12px; }
    .insight-card { background: var(--panel); border: 1px solid var(--border); border-radius: var(--radius); padding: 12px; display: grid; gap: 6px; }
    .insight-head { display: flex; justify-content: space-between; gap: 10px; align-items: center; }
    .level { padding: 4px 8px; border-radius: 999px; font-size: 12px; border: 1px solid var(--border); }
    .level.bajo { background: rgba(239,68,68,0.15); border-color: rgba(239,68,68,0.3); color: #fca5a5; }
    .level.intermedio { background: rgba(245,158,11,0.15); border-color: rgba(245,158,11,0.3); color: #fcd34d; }
    .level.alto { background: rgba(34,197,94,0.18); border-color: rgba(34,197,94,0.35); color: #bbf7d0; }
    .action-card { background: var(--panel); border: 1px solid var(--border); border-radius: var(--radius); padding: 12px; display: grid; gap: 8px; }
    .pill-sm { display: inline-flex; align-items: center; gap: 6px; padding: 4px 8px; border-radius: 999px; background: rgba(255,255,255,0.04); border: 1px solid var(--border); font-size: 11px; }
    .list { padding-left: 18px; color: var(--muted); font-size: 12px; }
    .toast { position: fixed; bottom: 16px; right: 16px; padding: 12px 14px; border-radius: 12px; background: #0f172a; border: 1px solid var(--border); color: var(--text); box-shadow: var(--shadow); display: none; }
    .modal-backdrop { position: fixed; inset: 0; background: rgba(0,0,0,0.55); display: none; align-items: center; justify-content: center; z-index: 40; }
    .modal { background: var(--panel); border: 1px solid var(--border); border-radius: 16px; padding: 16px; width: min(480px, 90%); box-shadow: var(--shadow); }
    canvas { max-width: 100%; }
    .empty-chart { color: var(--muted); font-size: 12px; text-align: center; padding: 12px 0; }
    .badge-grid { display: flex; gap: 8px; flex-wrap: wrap; margin-top: 8px; }
    .confetti { position: fixed; inset: 0; pointer-events: none; overflow: hidden; z-index: 50; }
    .confetti span { position: absolute; width: 8px; height: 14px; border-radius: 2px; background: var(--accent); animation: fall 1.8s linear forwards; opacity: 0.9; }
    @keyframes fall { to { transform: translateY(110vh) rotate(240deg); opacity: 0; } }
    @media (max-width: 1024px) {
      body { grid-template-columns: 1fr; }
      aside { position: static; height: auto; border-right: none; grid-template-columns: 1fr; }
      main { width: 100%; padding: 16px 12px 24px; }
      header.hero { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <aside>
    <div class="brand"><span class="logo">A</span><span>AlgoritmoT ¬∑ MD-IA</span></div>
    <div class="menu" id="sideMenu"></div>
    <div class="badge-grid" id="badgeContainer" aria-live="polite"></div>
    <button class="download" id="generateZip">‚ö° Generar paquete offline</button>
    <button class="download" id="downloadPdf">‚¨áÔ∏è Descargar reporte PDF</button>
  </aside>
  <main>
    <section class="card" id="welcomeCard" aria-label="Bienvenida">
      <div class="card-header">
        <div>
          <div class="card-title">Bienvenida ¬∑ Tab 0</div>
          <div class="card-subtitle">6 dimensiones ¬∑ 30 preguntas cada una ¬∑ Escala 1‚Äì5 ¬∑ Tiempo estimado 18‚Äì25 min</div>
        </div>
        <span class="chip">Tu progreso se guarda autom√°ticamente</span>
      </div>
      <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap:10px;">
        <div class="insight-card">
          <strong>Indicaciones</strong>
          <ul class="list">
            <li>Completa 30 preguntas por dimensi√≥n (bloques de 10).</li>
            <li>Responde con la escala 1‚Äì5 (1 = no se hace, 5 = optimizado).</li>
            <li>Puedes navegar libremente entre dimensiones sin perder respuestas.</li>
          </ul>
        </div>
        <div class="insight-card">
          <strong>Navegaci√≥n</strong>
          <ul class="list">
            <li>Pesta√±as laterales, botones Anterior/Siguiente y scroll suave en cada bloque.</li>
            <li>Atajos: n√∫meros 1‚Äì5 para seleccionar, flechas para subir/bajar, PageUp/PageDown para bloques.</li>
            <li>Hover en 4/5 muestra el significado exacto.</li>
          </ul>
        </div>
        <div class="insight-card">
          <strong>Env√≠o y resultados</strong>
          <ul class="list">
            <li>Bot√≥n Enviar dimensi√≥n se habilita al responder las 30 preguntas.</li>
            <li>Ver√°s modal de confirmaci√≥n, micro-radar, term√≥metro y badges.</li>
            <li>Radar global, DQ, AIQ y benchmark se activan tras el primer env√≠o.</li>
          </ul>
        </div>
      </div>
      <div class="wizard-controls" style="margin-top:12px;">
        <button class="btn" id="startWizard">Iniciar evaluaci√≥n</button>
      </div>
    </section>

    <header class="hero">
      <div>
        <h1>Cuestionario de madurez digital & IA</h1>
        <p>180 preguntas en 6 dimensiones. Usa el flujo paso a paso, guarda autom√°ticamente en tu navegador y genera resultados instant√°neos (DQ / AIQ) con insights por subdimensi√≥n.</p>
        <div style="margin-top:10px; display:flex; gap:8px; flex-wrap:wrap;">
          <span class="pill"><span class="badge"></span> 30 preguntas por dimensi√≥n</span>
          <span class="pill">Wizard con autoguardado local</span>
          <span class="pill">Tablero din√°mico bajo demanda</span>
        </div>
      </div>
      <div>
        <div class="hero-score">DQ 0% <small>¬∑ AIQ 0%</small></div>
        <div class="hero-grid">
          <div class="stat"><label>Avance global</label><strong id="globalProgress">0%</strong><div class="progress"><div class="progress-bar" id="globalProgressBar"></div></div></div>
          <div class="stat"><label>Dimensiones enviadas</label><strong id="dimsDone">0 / 6</strong></div>
          <div class="stat"><label>Estado</label><strong id="globalStatus">Iniciado</strong></div>
        </div>
      </div>
    </header>

    <div class="banner" aria-live="polite">
      <span>üìè Escala 1‚Äì5</span>
      <span>‚úÖ Debes responder todas las preguntas para enviar</span>
      <span>‚è±Ô∏è Tiempo estimado: 6‚Äì10 min por dimensi√≥n</span>
      <span id="wizardBreadcrumb" class="breadcrumb">Dimensi√≥n 1 ‚Ä∫ Estrategia ‚Ä∫ Pregunta 1/30</span>
    </div>

    <section class="grid grid-2" style="margin-top:14px;">
      <div>
        <div class="card">
          <div class="card-header">
            <div>
              <div class="card-title">Wizard por dimensi√≥n</div>
              <div class="card-subtitle">Navega con Siguiente/Anterior o usa 1‚Äì5 / flechas para responder.</div>
            </div>
            <div class="chip" id="blockChip">Bloque 1 de 3</div>
          </div>
          <div class="block-progress">
            <div>
              <div class="block-name" id="blockName">Gobernanza de IA</div>
              <div class="breadcrumb" id="blockBreadcrumb">Preguntas 1‚Äì10</div>
            </div>
            <div style="min-width:160px;">
              <div class="progress"><div class="progress-bar" id="blockProgressBar"></div></div>
            </div>
          </div>
          <div class="status" id="blockFeedback">Completa las 10 preguntas del bloque para continuar.</div>
          <div class="question-list" id="questionContainer" aria-live="polite"></div>
          <div class="wizard-controls">
            <button class="btn secondary" id="prevBtn">‚Üê Anterior</button>
            <button class="btn" id="nextBtn">Siguiente ‚Üí</button>
          </div>
          <div class="wizard-controls">
            <button class="btn secondary" id="prevDim">‚Üê Volver a la dimensi√≥n anterior</button>
            <button class="btn" id="nextDim">Guardar y continuar a la siguiente dimensi√≥n ‚Üí</button>
          </div>
          <div class="wizard-controls">
            <button class="btn" id="submitDim">Enviar dimensi√≥n</button>
          </div>
          <div class="status" id="wizardStatus">Autoguardado activo ¬∑ responde todas para enviar</div>
        </div>
      </div>
      <div class="grid" style="gap:10px;">
        <div class="card">
          <div class="card-header">
            <div>
              <div class="card-title">Micro-tablero de dimensi√≥n</div>
              <div class="card-subtitle">Radar + term√≥metro + pendientes</div>
            </div>
          </div>
          <div class="chart-wrap" id="miniRadarWrap"><div class="empty-chart">Env√≠a la dimensi√≥n para ver el radar</div></div>
          <div class="chart-wrap" id="thermoWrap"><div class="empty-chart">Term√≥metro de madurez</div></div>
          <div class="status" id="pendingQuestions">Te faltan 30 preguntas para completar toda la evaluaci√≥n</div>
        </div>
        <div class="card">
          <div class="card-header">
            <div>
              <div class="card-title">Resultados e insights</div>
              <div class="card-subtitle">Subdimensiones y an√°lisis autom√°tico</div>
            </div>
          </div>
          <div class="grid" id="dimensionInsights" style="grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));"></div>
        </div>
      </div>
    </section>

    <section class="card" style="margin-top:14px;" id="resultsCard">
      <div class="card-header">
        <div>
          <div class="card-title">Tablero de resultados (DQ / AIQ)</div>
          <div class="card-subtitle">Cargamos los gr√°ficos solo despu√©s del primer env√≠o</div>
        </div>
        <div class="chip" id="resultStatus">En espera</div>
      </div>
      <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(280px,1fr));" id="resultsCharts"></div>
      <div class="status" id="finalSummary">Env√≠a al menos una dimensi√≥n para activar radar, DQ, AIQ y benchmark.</div>
    </section>

    <section class="card" style="margin-top:14px;" id="actionsCard">
      <div class="card-header">
        <div>
          <div class="card-title">L√≠neas de acci√≥n sugeridas</div>
          <div class="card-subtitle">Quick wins y roadmap seg√∫n brechas</div>
        </div>
      </div>
      <div class="grid" id="actionsContainer" style="grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));"></div>
    </section>
  </main>

  <div class="toast" id="toast" role="status" aria-live="polite"></div>
  <div class="modal-backdrop" id="modalBackdrop">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <h3 id="modalTitle" style="font-size:18px; margin-bottom:6px;">‚úî Dimensi√≥n enviada</h3>
      <p id="modalBody" style="color: var(--muted);"></p>
      <div class="wizard-controls" style="margin-top:10px;">
        <button class="btn secondary" id="closeModal">Cerrar</button>
      </div>
    </div>
  </div>
  <div class="confetti" id="confetti"></div>

  <script type="module" src="questions.js"></script>
  <script type="module" src="state.js"></script>
  <script type="module" src="charts.js"></script>
  <script type="module" src="main.js"></script>
</body>
</html>
